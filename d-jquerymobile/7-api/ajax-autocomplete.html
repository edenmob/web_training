<!doctype html>
<html>
<head>
  <title>jQuery Mobile: Remote autocomplete</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <link rel="stylesheet" href="http://code.jquery.com/mobile/1.3.0/jquery.mobile-1.3.0.min.css" />
  <script type="text/javascript" src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
  <script src="http://code.jquery.com/mobile/1.3.0/jquery.mobile-1.3.0.min.js"></script>
  <script>
  $( document ).on( "pageinit", "#myPage", function() {
    $( "#autocomplete" ).on( "listviewbeforefilter", function ( e, data ) {
      var $ul = $( this ),
      $input = $( data.input ),
      value = $input.val(),
      html = "";
      $ul.html( "" );
      if ( value && value.length > 2 ) {
        $ul.html( "<li><div class='ui-loader'><span class='ui-icon ui-icon-loading'></span></div></li>" );
        $ul.listview( "refresh" );
        $.ajax({
          url: "http://gd.geobytes.com/AutoCompleteCity",
          dataType: "jsonp",
          crossDomain: true,
          data: {
            q: $input.val()
          }
        })
        .then( function ( response ) {
          $.each( response, function ( i, val ) {
            html += "<li>" + val + "</li>";
          });
          $ul.html( html );
          $ul.listview( "refresh" );
          $ul.trigger( "updatelayout");
        });
      }
    });
  });
  </script>
</head> 
<body>


  <div data-role="page" id="myPage">

    <div data-role="header">
      <h1>Remote auto-complete</h1>
    </div>

    <div data-role="content">
      <h3>Ville du monde</h3>
      <p>After you enter <strong>at least three characters</strong> the autocomplete function will show all possible matches.</p>
      <ul id="autocomplete" data-role="listview" data-inset="true" data-filter="true" data-filter-placeholder="Find a city..." data-filter-theme="d"></ul>
    </div>

    <div data-role="footer">
      <h4>Page Footer</h4>
    </div>

  </div>



</body>
</html>


